% !TEX root = Entwurf_goApp.tex

\section{Server}
	
	\hypertarget{database.model}{}
	\hypertarget{ServerModel}{}
	\subsection{edu.kit.pse.gruppe1.goApp.server.database.model}

	\subsubsection{public class User}
	An user describes an user of the goApp.
	\newline Attributes:
	\begin{itemize}
	\item private int id : The id is used to identify each user and is therefore unique and readonly.
	\item private String name : The name of an user is selectable by the user and can also be changed.
	\item private List<Group> groups : All groups the user is a member of.
	\item private Location location : The current location of the user
	\item private List<Event> events : all events the user has not rejected
	\end{itemize}
	Methods: 
	\begin{itemize}
	\item public User(int id, String name)
		\begin{description}
		\item @param id The Id of the user. 
	 	\item @param name The name of the user.
		\end{description}
	\item public getter of all attributes
	\item public setter of name and location
	\item public add of elemts to groups and events
	\item public delete of elemnts of groups and events
	\end{itemize}


	\subsubsection{public class Request}
	A request is created whenever a user wants to join a new group and deleted as soon as the founder adds or rejects the user.
	\newline Attributes:
	\begin{itemize}
	\item private Group group : readonly
	\item private User user : readonly
	\end{itemize}
	
	Methods: 
	\begin{itemize}
	\item public Request(User user, Group group)
		\begin{description}
		\item @param user The user who creates the request.
		\item @param group The group which the user wants to join.
		\end{description}
	\item public getter of all attributes
	\end{itemize}
	


\subsubsection {public class Participant} 
 the Participant class describes the status of a participant during the event.

Attributes:
\begin{itemize}
\item	private int status : can be: not participate, not seen, participate, started
\end{itemize}

	Methods: 
	\begin{itemize}
	\item getter and setter of status
	\end{itemize}

	
	\subsubsection{public class Group}
	A group is a composition of several users of the goApp, in which the users can create events.
	\newline Attributes:
	\begin{itemize}
	\item private int Id : The Id is used to identify each group and is therefore unique and readonly.
	\item private String name : The name of a group is given by the founder and can be changed.
	\item private User founder : created the group and can change name, members and can delete the group
	\item private List<User> members : all user in the group
	\item private List<Event> events : all events in the group
	\item private List<Request> requests  : all requests of the group
	
	\end{itemize}
	Methods:
	\begin{itemize}
	\item public Group(int id, String name)
		\begin{description}
		\item @param id The Id of the group.
		\item @param name The name of the group.
		\end{description}
	\item public getter of all attributes
	\item public setter of name and founder
	\item public add of elements of members, events and requests
	\item public delete of elements of members, events and requests
	\end{itemize}

	\subsubsection{public class Event}
	An event is created by a user within a specific group.
	\newline Attributes:
	\begin{itemize}
	\item private  int Id : The Id is used to identify each event and is therefore unique and readonly.
	\item private String name : The name of an event is given by the creator.
	\item private Time time : The time of an event tells when the event is starting and is set by the creator of the event.
	\item private Group group : The event is in the group. Readonly
	\item private Location destination : destination of the event
	\item private User admin : the creator of the events. The admin participates automatically . Readonly
	\item private List<User> participants : all member of the group who haven't rejected the event jet
	\item private List<Location> groupLocations : The locations which were calculated by the clustering algorithm
	\end{itemize}
	Methods:
	\begin{itemize}
	\item public Event(int id, String name, Time time)
		\begin{description}
		\item @param id The Id of the event.
		\item @param name The name of the event.
		\item @param time The time of the event.
		\end{description}
	\item public getter of all attributes
	\item public setter of name, time and destination
	\item public add of participants and groupLocations
	\item public delete of participants and groupLocations
	\end{itemize}

	\subsubsection{public class Location}
	An event is created by a user within a specific group.
	\newline Attributes:
	\begin{itemize}
	\item private  double longitude : The longitude value of the position in degrees, range[-180,180). 
	\item private  double latitude : The latitude value of the position in degrees, range [-90,90].
	\item private String name : The name of a location helps the user to identify if the location is a center point of the group or the original meeting point.
	\end{itemize}
	Methods:
	\begin{itemize}
	\item public Location(int longitude, int latitude, String name)
		\begin{description}
		\item @param longitude The longitude value of the position.
		\item @param latitude The latitude value of the position.
		\item @param name The name of the location.
		\end{description}
	\item getter of all attributes
	\item setter of all attributes
	\end{itemize}


\hypertarget{database.management}{}
	\subsection{edu.kit.pse.gruppe1.goApp.server.database.management}	
	%TODO: Kurzer Beschreibungstext

	\subsubsection{DatabaseInitializer}
	Factory for creating Session Factory for DB communication.
	\newline 
	Attributes:
	\begin{itemize}
		\item private static SessionFactory factory;
		\begin{description}
			\item This is the only SessionFactory on the Server
		\end{description}
	\end{itemize}
	Methods:
	\begin{itemize}
		\item public static SessionFactory getFactory()
		\begin{description}
			\item Method returns the attribute factory and initialize factory if it is null
			\item @return SessionFactory Object from Hibernate Library
		\end{description}
	\end{itemize}
	
	\subsubsection{Interface Management}
	Interface to use from all DB Management Classes
	\newline Methods:
	\begin{itemize} 
		\item public boolean delete(int ID)			
		\begin{description}
			\item Delete an entry with ID in DB
			\item @param ID ID from Entry to delete
			\item @return true, if deletion was successfull, otherwise false
		\end{description}
		\end{itemize}
	
	\subsubsection{GroupManagement}
	Manages Group Table
		\newline Methods:
		\begin{itemize}
			\item public Group add(String name, User founder)
			\begin{description}
				\item creates new Group and adds new entry to table
				\item  @param name Name of Group
				\item  @param founder Founder of Group (User)
				\item  @return created Group
			\end{description}
			\item public boolean update(Group chGroup)
			\begin{description}
				\item updates entry in table
				\item  @param chGroup Group with changed attributes
				\item  @return true, if update was successfull, otherwise false
			\end{description}
			\item public boolean updateName(int groupID, String newName)
			\begin{description}
				\item updates name of entry
				\item @param groupID ID of entry to change
				\item @param newName Name to set
				\item @return true, if update was successfull, otherwise false
			\end{description}
			\item public boolean updateFounder(int groupID, User newFounder)
			\begin{description}
				\item updates founder of given entry
				\item  @param groupID ID of entry to change
				\item  @param newFounder Founder to set
			\end{description}
			\item public Group getGroup(int groupID)
			\begin{description}
				\item returns Group with given GruopID
				\item  @param groupID ID of Group to get
				\item  @return a Group
			\end{description}
			\item public List<edu.kit.sdqweb.pse.gruppe1.goApp.client.model.Group> getGroupsByMember(String member)
			\begin{description}
				\item get all Groups with given Member
				\item @param member Name of Member
				\item @return List of Groups
			\end{description}
			\item public List<pse.goApp.client.model.Group> getGroupsByName(String searchName)
			\begin{description}
				\item get all Groups with given Name
				\item @param searchName name to search for
				\item @return List of matching Groups
			\end{description}
			\item public boolean addMember(int groupID, int memberId)
			\begin{description}
				\item add Member to Group
				\item @param groupID ID of group to add a new member to
				\item @param memberId ID of User to add to group
				\item @return true, if adding was successfull, otherwise false
			\end{description}
			\item public boolean deleteMember(int groupID, int memberID)
			\begin{description}
				\item delete member from group
				\item @param groupID ID of group to delete member from
				\item @param memberID ID of member to delete
				\item @return true, if deletion was successfull, otherwise false
			\end{description}
			\item public List<edu.kit.sdqweb.pse.gruppe1.goApp.client.model.Event> getEvents(int groupID)
			\begin{description}
				\item return all Events which are connected with given Group
				\item  @param groupID GroupID to search Events for
				\item  @return List of Events
			\end{description}
		\end{itemize}
		
	\subsubsection{UserManagement}
	Manages User Table
		\newline Methods:
		\begin{itemize}
			\item public User add(String name, int googleId)public User add(String name, int googleId)
			\begin{description}
				\item creates new User and adds new entry to table
				\item  @param name name of User
				\item  @param googleId googleID of User
				\item  @return userID of entry
			\end{description}
			\item public boolean update(User chUser)
			\begin{description}
				\item changes entry in table
				\item  @param chUser User Object with changes
				\item  @return true, if change was successfull, otherwise false
			\end{description}
			\item public boolean updateName(int userID, String newName)
			\begin{description}
				\item updates Name of User
				\item @param userID ID from user to update
				\item @param newName name to set
				\item @return true, if update was successfull, otherwise false
			\end{description}
			\item public boolean updateLocation(int userId, Location newLocation)
			\begin{description}
				\item updates current location of user
				\item @param userId userID from entry to update
				\item @param newLocation new Location of user
				\item @return true, if update was successfull, otherwise false
			\end{description}
			\item public User getUser(int userID)
			\begin{description}
				\item get User with given userID
				\item  @param userID ID of User to search for
				\item  @return found User
			\end{description}
		\end{itemize}
		
	\subsubsection{EventManagement}
	Manages Event Table
		\newline Methods:
		\begin{itemize}
			\item public Event add(String name, Location location, DateTime time, int userId, int groupID)
			\begin{description}
				\item creates new Group and adds new entry to table
				\item adds all User from Group to Event and sets Status
				\item @param name Name of Event
				\item @param location Location, where Event takes place
				\item @param time Date and Time, when Event takes place
				\item @param userId ID of User who created the Event
				\item @param groupID ID of Group to which Event is related to
			\end{description}
			\item public boolean update(Event chEvent)
			\begin{description}
				\item updates entry in table
				\item  @param chEvent Event with changes
				\item  @return true, if update was successful, otherwise false
			\end{description}
			\item public boolean updateName(int eventID, String name)
			\begin{description}
				\item updates entry with given id - sets new name
				\item  @param eventID ID of entry to be updated
				\item  @param name new Name of Entry
				\item  @return true, if update was successfull, otherwise false
			\end{description}
			\item public boolean updateStatus(int userID, int eventID, boolean newStatus)
			\begin{description}
				\item sets new status to entry with given ID
				\item  @param userID ID from user
				\item  @param eventID ID from Event
				\item  @param newStatus status to set
				\item  @return true, if update was successfull, otherwise false
			\end{description}
			\item public Event getEvent(int eventID)
			\begin{description}
				\item gets Event with given eventID
				\item  @param eventID ID of event
				\item  @return matching  Event
			\end{description}
			\item public int getUser(int eventID)
			\begin{description}
				\item get User who created Event
				\item @param eventID ID of entry
				\item @return ID of User
			\end{description}
		\end{itemize}
		
	\subsubsection{EventUserManagement}
	Manages Event-User Table
		\newline Methods:
		\begin{itemize}
			\item public boolean add(int eventId, int userId)
			\begin{description}
				\item adds new entry to table
				\item  @param eventId eventID to combine with user
				\item  @param userId userID to combine with Event
			\end{description}
			\item public boolean updateStatus(int eventID, int userID, boolean newStatus)
			\begin{description}
				\item updates Status of given user and eventID
				\item  @param eventID eventID to upate
				\item @param userID userID to update
				\item  @param newStatus new Status to set
				\item  @return true, if update was successfull, otherwise false
			\end{description}
			\item public boolean delete(int eventID, int userID)
			\begin{description}
				\item removes entry (with userID and eventID)
				\item  @param eventID eventID to remove
				\item  @param userID userID to remove
				\item  @return true, if update was successfull, otherwise false
			\end{description}
			\item public List<pse.goApp.client.model.Event> getEvents(int userID)
			\begin{description}
				\item get all events in which given user participates
				\item @param userID ID of user
				\item @return List of matching Events
			\end{description}
			\item public List<edu.kit.sdqweb.pse.gruppe1.goApp.client.model.User> getUsers(int eventID)
			\begin{description}
				\item get all users which participate in given Event
				\item  @param eventID ID of event
				\item  @return List of matching User
			\end{description}
			\item public List<edu.kit.sdqweb.pse.gruppe1.goApp.client.model.User> getUserByStatus(String status, int eventID)
			\begin{description}
				\item get all User with given Status from an Event
				\item @param status status to search for
				\item @param eventID ID of event to search for
				\item @return List of matching Users
			\end{description}
		\end{itemize}
		
	\subsubsection{GroupUserManagement}
	Manages Group-User Table
		\newline Methods:
		\begin{itemize}
			\item public boolean add(int gruopID, int userID)
			\begin{description}
				\item creates new entry
				\item  @param gruopID groupID to combine with user
				\item  @param userID userID to combine with group
				\item  @return ID of new entry
			\end{description}
			\item public List<pse.goApp.client.model.User> getUsers(int gruopID)
			\begin{description}
				\item get all User to given Gruop
				\item  @param gruopID ID of group
				\item @return List of matching User
			\end{description}
			\item public List<pse.goApp.client.model.Group> getGroups(int userID)
			\begin{description}
				\item get all groups to given User
				\item @param userID ID of User
				\item @return List of matching Groups
			\end{description}
			\item public boolean delete(int groupID, int userID)
			\begin{description}
				\item deletes entry in table with given GroupID and userID
				\item @param groupID groupID to delete (in combination)
				\item @param userID userID to delete (in combination)
				\item @return true, if successful, otherwise false
			\end{description}
		\end{itemize}
		
	\subsubsection{RequestManagement}
	Manages Request Table
		\newline Methods:
		\begin{itemize}
			\item public boolean add(int gruopID, int userID)
			\begin{description}
				\item creates new entry
				\item @param gruopID groupID to combine with user
				\item @param userID userID to combine with group
				\item @return ID of new entry
			\end{description}
			\item public List<pse.goApp.client.model.User> getRequestByGroup(int gruopID)
			\begin{description}
				\item get all User to given Gruop
				\item @param gruopID ID of group
				\item @return List of matching Users
			\end{description}
			\item public List<pse.goApp.client.model.Group> getRequestByUser(int userID)
			\begin{description}
				\item get all groups to given User
				\item @param userID ID of User
				\item @return List of matching Groups
			\end{description}
			\item public boolean delete(int groupID, int userID)
			\begin{description}
				\item delete entry with given groupID and userID
				\item @param groupID
				\item @param userID
				\item @return true, if deletion was successful, otherwise false
			\end{description}
		\end{itemize}
  
  \hypertarget{algorithm}{}
  	\subsection{edu.kit.pse.gruppe1.goApp.server.algorithm}
	
	
	\subsubsection{CusterFacade}
	
	%TODO: Kurzer Beschreibungstext
	Facade Class which communicates with the servlet and the database.
	%TODO: Hinterher Löschen - Vorlage
	\newline Attributes:
	\newline Methods:
	\begin{itemize}
		\item public List<Point> getClusteredCentralPoints(Event event) :
		\begin{description}
			\item This method fetches all locations from the database which belong to the event and calls the cluster algorithm to get it clustered. After that it calls the MidpointAlgo to get the midpoints from the calculated clusters.
			\item @param the event which midpoint should be calculated.
			\item @return central points of the calculated clusters
		\end{description}
	\end{itemize}
	
	

	
	
	\subsubsection{abstract MidPointAlgo}
	
	This is the abstract class with the method to calculate the central of a cluster.

	Methods:
	\begin{itemize}
		\item public Point calculateCentralPoint(CentroidCluster cluster) 
		\begin{description}
			\item This is the abstract method for calculating a clusters central point.
			\item param the cluster which midpoint should be calculated.
			\item return the midpoint.
		\end{description}
	\end{itemize}
	%TODO bis hier
	
	
	
	\subsubsection{SimpleCentral extends MidPointAlgo}
	
	This is the class which calculates the arithmetic midpoint. It extends the class MidPointAlgo and overwrites its methods.	
	
	
	
	
	
	
	\subsubsection{ImportantMidPointCentral extends MidPointAlgo}
	
	This class is for calculating the midpoint of a cluster but not every point is weighted the same, especially the midpoint of the cluster is more important than other points. It overwrites the method calculateCentralPoint from its super class MidPointAlgo. 	
	
	

	\subsection{edu.kit.pse.gruppe1.goApp.server.servlet}
	Das Package servlet nimmt auf dem Server alle Anfragen der Clienten entgegen wertet sie aus und leitet diese entsprechend weiter. Eine Beschreibung aller Servlets findet sich \hyperlink{Servlets}{hier}, weil sie thematisch besser in das Kapitel Kommunikation Server \& Client passt.
	\newpage
